"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[415],{5415:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var r=n(3433),a=n(9439),o=n(2791),s=n(7985),i=n(4964),c=n(2085),u=n(2692),l=n(135),d=n(3506),h=n(9602),m=n(4195),p=n(3099),f=n(501),Z=n(292),x=n(2426),j=n.n(x),g=n(3449),y=(n(2173),n(184));function k(){var e=[{title:"\u5ba2\u6237",dataIndex:"customer"},{title:"\u7535\u8bdd\u53f7\u7801",dataIndex:"phone"},{title:"\u4ee3\u7406",dataIndex:"user"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"creatTime"},{title:"\u64cd\u4f5c",render:function(e){return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(i.Z,{type:"primary",onClick:function(){return K(e)},style:{marginRight:"8px"},children:"\u7f16\u8f91"}),(0,y.jsx)(i.Z,{type:"primary",onClick:function(){return M(e)},danger:!0,children:"\u5220\u9664"})]})}}],t=c.Z.useForm(),n=(0,a.Z)(t,1)[0],x=c.Z.useForm(),j=(0,a.Z)(x,1)[0],k=(0,o.useState)(""),v=(0,a.Z)(k,2),I=v[0],S=v[1],w=(0,o.useState)(!1),b=(0,a.Z)(w,2),T=b[0],F=b[1],C=(0,o.useState)(!1),q=(0,a.Z)(C,2),D=q[0],P=q[1],_=(0,o.useState)([]),z=(0,a.Z)(_,2),B=z[0],E=z[1],L=(0,o.useState)(1),G=(0,a.Z)(L,2),J=G[0],R=G[1],U=(0,o.useState)(0),V=(0,a.Z)(U,2),A=V[0],O=V[1];(0,o.useEffect)((function(){(0,s.Bq)().then((function(e){O(e.data.total);var t=[];e.data.data.forEach((function(e){t.push({key:e._id,phone:e.phone,customer:e.customer,user:e.user.username,creatTime:new Date(e.creatTime).toLocaleDateString()})})),E(t)}))}),[]);var H=function(e){R(1);var t={phone:e.phone?e.phone:"",customer:e.customer?e.customer:"",creatTime:e.date?e.date.unix():0,page:e.page?e.page:1};(0,s.Z)(t).then((function(e){O(e.data.total);var t=[];e.data.data.forEach((function(e){t.push({key:e._id,phone:e.phone,customer:e.customer,user:e.user.username,creatTime:new Date(e.creatTime).toLocaleDateString()})})),E(t),P(!0)}))},K=function(e){e.key?(j.setFieldsValue(e),S("\u4fee\u6539\u4fe1\u606f")):S("\u6dfb\u52a0\u4fe1\u606f"),F(!0)},M=function(e){(0,s.vG)({_id:e.key}).then((function(t){var n=(0,r.Z)(B);n=n.filter((function(t){return t.key!==e.key})),E(n),O(10*(J-1)+n.length),u.ZP.success(t.data.message)}))};return(0,y.jsxs)("div",{children:[(0,y.jsxs)(c.Z,{form:n,name:"search",layout:"inline",onFinish:H,children:[(0,y.jsx)(c.Z.Item,{name:"customer",children:(0,y.jsx)(l.Z,{prefix:(0,y.jsx)(f.Z,{}),placeholder:"\u5ba2\u6237"})}),(0,y.jsx)(c.Z.Item,{name:"phone",children:(0,y.jsx)(l.Z,{prefix:(0,y.jsx)(Z.Z,{}),placeholder:"\u7535\u8bdd\u53f7\u7801"})}),(0,y.jsx)(c.Z.Item,{name:"date",children:(0,y.jsx)(d.Z,{placeholder:"\u9009\u62e9\u65f6\u95f4",locale:g.Z})}),(0,y.jsx)(c.Z.Item,{shouldUpdate:!0,children:(0,y.jsx)(i.Z,{type:"primary",htmlType:"submit",children:"\u641c\u7d22"})}),(0,y.jsx)(c.Z.Item,{children:(0,y.jsxs)("p",{style:{margin:"0 50px"},children:["\u603b\u6570\uff1a",A," \u6761"]})}),(0,y.jsx)(c.Z.Item,{children:(0,y.jsx)(i.Z,{type:"primary",onClick:K,children:"\u6dfb\u52a0\u4fe1\u606f"})})]}),(0,y.jsx)(h.Z,{columns:e,dataSource:B,pagination:{current:J,total:A,pageSize:10,showSizeChanger:!1,onChange:function(e){if(D){var t=n.getFieldsValue(!0);t.page=e,H(t)}else(0,s.Bq)({page:e}).then((function(e){O(e.data.total);var t=[];e.data.data.forEach((function(e){t.push({key:e._id,phone:e.phone,customer:e.customer,user:e.user.username,creatTime:new Date(e.creatTime).toLocaleDateString()})})),E(t)}));R(e)}}}),(0,y.jsx)(m.Z,{title:I,placement:"right",closable:!1,onClose:function(){j.resetFields(),F(!1)},visible:T,extra:(0,y.jsx)(p.Z,{}),children:(0,y.jsxs)(c.Z,{form:j,name:"edit",onFinish:function(e){var t={};t=e.key?{_id:e.key,phone:e.phone?e.phone:"",customer:e.customer?e.customer:""}:{phone:e.phone?e.phone:"",customer:e.customer?e.customer:""},(0,s.Jq)(t).then((function(e){u.ZP.success(e.data.message)})),j.resetFields(),F(!1)},children:[(0,y.jsx)(c.Z.Item,{name:"customer",label:"\u5ba2\u6237",children:(0,y.jsx)(l.Z,{})}),(0,y.jsx)(c.Z.Item,{name:"phone",label:"\u53f7\u7801",children:(0,y.jsx)(l.Z,{})}),(0,y.jsx)(c.Z.Item,{name:"key",children:(0,y.jsx)(l.Z,{type:"hidden"})}),(0,y.jsx)(c.Z.Item,{children:(0,y.jsx)(i.Z,{type:"primary",htmlType:"submit",children:"\u63d0\u4ea4"})})]})})]})}j().locale("zh-cn")},7985:function(e,t,n){n.d(t,{vG:function(){return d},Jq:function(){return h},Bq:function(){return l},Z:function(){return m},Ig:function(){return c},pk:function(){return u}});var r=n(4569),a=n.n(r),o=n(2692),s=a().create({baseURL:"/web/"});s.interceptors.request.use((function(e){return localStorage.token&&(e.headers.Authorization="Bearer "+localStorage.token),e}),(function(e){return Promise.reject(e)})),s.interceptors.response.use((function(e){return e}),(function(e){return 401===e.response.status&&(localStorage.removeItem("token"),window.location.hash.indexOf("register")&&(window.location.hash="/login")),e.response.data?(o.ZP.error(e.response.data),Promise.reject(e)):Promise.reject(e)}));var i=s,c=function(e){return i.post("/login",e)},u=function(e){return i.post("/register",e)},l=function(e){return i.get("/data",{params:e})},d=function(e){return i.delete("/data",{params:e})},h=function(e){return i.put("/data",e)},m=function(e){return i.post("/data",e)}}}]);
//# sourceMappingURL=415.aa608971.chunk.js.map